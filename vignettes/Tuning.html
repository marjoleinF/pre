<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Marjolein Fokkema" />


<title>Tuning the parameters of function pre</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Tuning the parameters of function pre</h1>
<h4 class="author">Marjolein Fokkema</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Function <code>pre()</code> has a substantial number of model-fitting parameters, which may be tuned so as to optimize predictive accuracy and/or interpretability (sparsity) of the final model. For many of the parameters, default settings will likely perform well. Here, we discuss the effects of several of the parameters on predictive accuracy and model complexity. Next, we illustrate how to optimize predictive accuracy for a binary classification problem using package <strong><code>caret</code></strong>. We do not explain each argument in detail; readers are referred to the documentation of function <code>pre()</code> for that, or Fokkema (2020).</p>
</div>
<div id="tuning-parameters" class="section level2">
<h2>Tuning parameters</h2>
<p>The following arguments of function <code>pre()</code> can be expected to affect predictive accuracy and complexity of the final ensemble (ordered roughly from most to least likely candidates to require tuning):</p>
<ul>
<li><p><code>learnrate</code>: Carefully tuning this parameter is likely to be the most beneficial in terms of predictive accuracy. There are no rules of thumb on how complexity and predictive accuracy will be affected by setting this argument to higher or lower than the default of 0.01. In light of the default value of <code>ntrees = 500</code>, the default of 0.01 is likely a very good starting points. Somewhat higher and lower values may be tried; lower values are likely beneficial only when argument <code>ntrees</code> is set to a higher value. A reasonable starting point would be to specify a grid search over <code>c(0.01, 0.05, 0.1)</code> or <code>c(0.005, 0.01, 0.025, 0.05, 0.1)</code>.</p></li>
<li><p><code>maxdepth</code>: The default of three generates rules with at most 3 conditions, which are relatively easy to interpret. Somewhat higher or lower values may be preferred. Setting `<code>maxdepth = 1</code> will yield a model with main effects of predictor variables only.</p></li>
<li><p><code>sampfrac</code>: Depending on training sample size, values higher or lower than the default of .5 may be beneficial. Often smaller samples require higher values of <code>sampfrac</code>, sometimes even a value of 1 can be most beneficial for predictive accuracy; for larger samples, lower <code>sampfrac</code> values may suffice (and will reduce computation time).</p></li>
<li><p><code>ntrees</code>: Setting higher values than the default of 500 may increase complexity as well as predictive accuracy.</p></li>
<li><p><code>type</code>: The default of <code>&quot;both&quot;</code> will likely perform best in terms of predictive accuracy. Setting <code>type = &quot;rules&quot;</code> will yield a more complex final ensemble in most cases, but is unlikely to improve predictive accuracy. Setting <code>type = &quot;linear&quot;</code> simply yields a penalized regression model, which will likely have somewhat lower predictive accuracy, but also lower complexity.</p></li>
<li><p><code>mtry</code>: It is difficult to predict how setting this parameter to lower values than the default of <code>mtry = Inf</code> will affect complexity and predictive accuracy. Setting <code>mtry</code> to values <span class="math inline">\(&lt; p\)</span> (the number of possible predictors) employs a random-forest like approach to rule induction. In the authors experience, the default boosting approach to rule induction works very well. Setting <code>mtry</code> to values <span class="math inline">\(&lt; p\)</span> will however reduce the computational burden of rule generation, which may be desirable especially with larger datasets (large <span class="math inline">\(N\)</span> and/or large <span class="math inline">\(p\)</span>).</p></li>
<li><p><code>use.grad</code>: the default of <code>TRUE</code> will likely perform well in most cases. With not-too-large sample sizes, setting <code>use.grad = FALSE</code> likely yields a more complex ensemble, which may have somewhat better predictive accuracy.</p></li>
</ul>
<p>Furthermore, most methods for class <code>pre</code> (e.g., <code>predict</code>, <code>print</code>, <code>summary</code>, <code>coef</code>) take argument <code>penalty.par.val</code>, which by default is set to <code>lambda.1se</code>, as it tends to yield a good balance between predictive accuracy and complexity. Setting this argument to <code>lambda.min</code> may improve predictive accuracy but will also increase complexity of the final ensemble.</p>
</div>
<div id="tuning-parameters-using-package-caret" class="section level2">
<h2>Tuning parameters using package caret</h2>
<p>We first load the required libraries:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;caret&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;pre&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;pROC&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
<p>The parameters of function <code>pre()</code> can be tuned using function <code>train()</code> from package <strong><code>caret</code></strong>. By default, squared error loss is minimized in case of numeric outcomes, which will be appropriate in many cases. (Weighted) misclassification error will be minimized by default for classification problems, which in most cases is not appropriate. In general, one should care about the quality of predicted probabilities, not just about the accuracy of the class labels assigned. Squared error loss on predicted probabilities (also known as the Brier score) should in many cases be preferred, or perhaps the area under the receiver operating curve.</p>
<p>To adjust the default of optimizing classification error, we set up a custom function in order to optimize the Brier score or AUC. For numeric outcomes, this will not be necessary, and the <code>summaryFunction</code> of the <code>trainControl</code> function need not be specified (see next code chunk).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>BigSummary <span class="ot">&lt;-</span> <span class="cf">function</span> (data, <span class="at">lev =</span> <span class="cn">NULL</span>, <span class="at">model =</span> <span class="cn">NULL</span>) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  brscore <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">mean</span>((data[, lev[<span class="dv">2</span>]] <span class="sc">-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>obs <span class="sc">==</span> lev[<span class="dv">2</span>], <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">^</span> <span class="dv">2</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  rocObject <span class="ot">&lt;-</span> <span class="fu">try</span>(pROC<span class="sc">::</span><span class="fu">roc</span>(<span class="fu">ifelse</span>(data<span class="sc">$</span>obs <span class="sc">==</span> lev[<span class="dv">2</span>], <span class="dv">1</span>, <span class="dv">0</span>), data[, lev[<span class="dv">2</span>]],</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">direction =</span> <span class="st">&quot;&lt;&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>), <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(brscore, <span class="st">&quot;try-error&quot;</span>)) brscore <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  rocAUC <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">inherits</span>(rocObject, <span class="st">&quot;try-error&quot;</span>)) {</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NA</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    rocObject<span class="sc">$</span>auc</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">AUCROC =</span> rocAUC, <span class="at">Brier =</span> brscore))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Next, we set up a control object for the <code>train()</code> function. Opinions may vary on what are the best setting for optimizing tuning parameters on a training dataset. Here, we take a 10-fold cross validation approach. Often, 10 repeats of 10-fold cross validation should be preferred, to make results less dependent on a single choice of folds. This can be done by setting <code>repeats = 10</code> instead of the default below:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fitControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>, <span class="at">repeats =</span> <span class="dv">1</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">classProbs =</span> <span class="cn">TRUE</span>, <span class="do">## get probabilities, not class labels</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">summaryFunction =</span> BigSummary, <span class="at">verboseIter =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Next, we set up a custom tuning grid for the parameters of function <code>pre()</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>preGrid <span class="ot">&lt;-</span> <span class="fu">getModelInfo</span>(<span class="st">&quot;pre&quot;</span>)[[<span class="dv">1</span>]]<span class="sc">$</span><span class="fu">grid</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">maxdepth =</span> 3L<span class="sc">:</span>4L,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">learnrate =</span> <span class="fu">c</span>(.<span class="dv">01</span>, .<span class="dv">05</span>, .<span class="dv">1</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">penalty.par.val =</span> <span class="fu">c</span>(<span class="st">&quot;lambda.1se&quot;</span>, <span class="st">&quot;lambda.min&quot;</span>),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sampfrac =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1.0</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(preGrid)</span></code></pre></div>
<pre><code>##   sampfrac maxdepth learnrate mtry use.grad penalty.par.val
## 1     0.50        3      0.01  Inf     TRUE      lambda.1se
## 2     0.75        3      0.01  Inf     TRUE      lambda.1se
## 3     1.00        3      0.01  Inf     TRUE      lambda.1se
## 4     0.50        4      0.01  Inf     TRUE      lambda.1se
## 5     0.75        4      0.01  Inf     TRUE      lambda.1se
## 6     1.00        4      0.01  Inf     TRUE      lambda.1se</code></pre>
<p>Note that tuning and fitting PREs can be computationally heavy, especially with increasing size of the tuning grid, and a smaller grid of tuning parameter values may be preferred.</p>
<p>Note that the <code>ntrees</code> parameter is not included in the default grid-generating function (<code>getModelInfo(&quot;pre&quot;)[[1]]$grid</code>). One can deviate from the default of <code>ntrees = 500</code> by passing this argument calling function <code>train()</code> multiple times, and specifying a different value for <code>ntrees</code> each time (example provided below). The same goes for other arguments of function <code>pre()</code> that are not part of the default tuning parameters of <strong><code>caret</code></strong>â€™s method <code>&quot;pre&quot;</code>.</p>
<p>In this example, we focus on the (perhaps somewhat uninteresting, but useful as an example) problem of predicting sex <code>sexo</code> from the <code>carrillo</code> data included in package <strong><code>pre</code></strong> (type <code>?carrillo</code> for explanation of the data and variables).</p>
<p>We rename the levels of the outcome variable because the <code>train</code> function of <strong><code>caret</code></strong> does not appreciate when factor levels are numbers:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>carrillo<span class="sc">$</span>sexo <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">paste0</span>(<span class="st">&quot;g&quot;</span>, <span class="fu">as.character</span>(carrillo<span class="sc">$</span>sexo)))</span></code></pre></div>
<p>Note that the current dataset is rather small (112 observations). Still, to illustrate the principle of tuning parameters using training data, and evaluating predictive accuracy of the final fitted model using unseen test observations, we make a 75-25% train-test split:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>train_ids <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(carrillo), .<span class="dv">75</span><span class="sc">*</span><span class="fu">nrow</span>(carrillo))</span></code></pre></div>
<p>Next, we optimize the parameters. Note that this is a computationally heavy task so we need to be patient. We specified <code>verboseIter = TRUE</code> above, so progress information will be printed to the command line:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>pre_tune <span class="ot">&lt;-</span> <span class="fu">train</span>(sexo <span class="sc">~</span> ., <span class="at">data =</span> carrillo[train_ids, ], <span class="at">method =</span> <span class="st">&quot;pre&quot;</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ntrees =</span> <span class="dv">500</span>, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> fitControl, <span class="at">tuneGrid =</span> preGrid,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">&quot;Brier&quot;</span>, <span class="do">## Specify &quot;AUCROC&quot; for optimizing AUC</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">maximize =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>pre_tune2 <span class="ot">&lt;-</span> <span class="fu">train</span>(sexo <span class="sc">~</span> ., <span class="at">data =</span> carrillo[train_ids, ], <span class="at">method =</span> <span class="st">&quot;pre&quot;</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ntrees =</span> <span class="dv">1000</span>, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> fitControl, <span class="at">tuneGrid =</span> preGrid, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">&quot;Brier&quot;</span>, <span class="at">maximize =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Some warnings (<code>Warning: from glmnet Fortran code (error code -83)</code>) will be reported, but these are not worrying; for some models, computations for some values in the <span class="math inline">\(\lambda\)</span> path could not be completed.</p>
<p>We inspect the results:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ids <span class="ot">&lt;-</span> <span class="fu">which</span>(pre_tune<span class="sc">$</span>results<span class="sc">$</span>Brier <span class="sc">==</span> <span class="fu">min</span>(pre_tune<span class="sc">$</span>results<span class="sc">$</span>Brier))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>pre_tune<span class="sc">$</span>results[ids, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">10</span>)]</span></code></pre></div>
<pre><code>##    sampfrac maxdepth learnrate mtry use.grad penalty.par.val   BrierSD
## 25        1        3      0.01  Inf     TRUE      lambda.1se 0.1340773
## 26        1        3      0.01  Inf     TRUE      lambda.min 0.1340773</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pre_tune,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">list</span>(<span class="at">cex =</span> .<span class="dv">7</span>), <span class="at">ylab =</span> <span class="fu">list</span>(<span class="at">cex =</span> .<span class="dv">7</span>),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">scales =</span> <span class="fu">list</span>(<span class="at">cex=</span>.<span class="dv">7</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">par.strip.text=</span><span class="fu">list</span>(<span class="at">cex=</span>.<span class="dv">7</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ids2 <span class="ot">&lt;-</span> <span class="fu">which</span>(pre_tune2<span class="sc">$</span>results<span class="sc">$</span>Brier <span class="sc">==</span> <span class="fu">min</span>(pre_tune2<span class="sc">$</span>results<span class="sc">$</span>Brier))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>pre_tune2<span class="sc">$</span>results[ids2, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">10</span>)]</span></code></pre></div>
<pre><code>##    sampfrac maxdepth learnrate mtry use.grad penalty.par.val   BrierSD
## 31        1        4      0.01  Inf     TRUE      lambda.1se 0.1288889
## 32        1        4      0.01  Inf     TRUE      lambda.min 0.1288889</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pre_tune2, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">list</span>(<span class="at">cex =</span> .<span class="dv">7</span>), <span class="at">ylab =</span> <span class="fu">list</span>(<span class="at">cex =</span> .<span class="dv">7</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">scales =</span> <span class="fu">list</span>(<span class="at">cex=</span>.<span class="dv">7</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">par.strip.text=</span><span class="fu">list</span>(<span class="at">cex=</span>.<span class="dv">7</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Both with <code>ntrees = 500</code> and <code>1000</code>, the default value for the <code>learnrate</code> argument appears optimal; for the <code>sampfrac</code> argument, a higher value than the default seems beneficial. This latter result is likely to occur with smaller datasets only, as in most cases subsampling for rule generation may be expected beneficial. Setting <code>ntrees = 1000</code> (default is 500) and <code>maxdepth = 4</code> (default is 3) may improve performance.</p>
<p>Note that both <code>lambda.1se</code> and <code>lambda.min</code> criteria yield optimal and identical performance. It is likely that both penalty parameter criteria yield the exact same model. When both criteria yield similar or identical predictive accuracy, we prefer <code>lambda.1se</code> because it yields a sparser model. Note that <code>lambda.1se</code> is the default in <code>pre</code>, because it better accounts for the exploratory rule search.</p>
<p>We refit model using optimal parameters:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>opt_pre_mod <span class="ot">&lt;-</span> <span class="fu">pre</span>(<span class="at">formula =</span> sexo <span class="sc">~</span> ., <span class="at">data =</span> carrillo[train_ids, ],</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sampfrac =</span> <span class="dv">1</span>, <span class="at">maxdepth =</span> <span class="dv">4</span>, <span class="at">ntrees =</span> <span class="dv">1000</span>, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span></code></pre></div>
<p>We also compare against accuracy that would have been obtained using default parameter settings:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>def_pre_mod <span class="ot">&lt;-</span> <span class="fu">pre</span>(<span class="at">formula =</span> sexo <span class="sc">~</span> ., <span class="at">data =</span> carrillo[train_ids, ],</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span></code></pre></div>
<p>Get results and predictions from each of the models:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(opt_pre_mod, <span class="at">penalty.par.val =</span> <span class="st">&quot;lambda.1se&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Final ensemble with cv error within 1se of minimum: 
##   lambda =  0.07459569
##   number of terms = 11
##   mean cv error (se) = 1.235626 (0.07320966)
## 
##   cv error type : Binomial Deviance
## 
##          rule  coefficient                       description
##   (Intercept)  -0.15430997                                 1
##        rule31   0.48357486    n3 &gt; 13 &amp; e1 &gt; 18 &amp; open3 &gt; 18
##       rule232  -0.38229846  e5 &gt; 12 &amp; open6 &lt;= 22 &amp; n3 &lt;= 17
##       rule627  -0.26965307            n3 &lt;= 16 &amp; altot &lt;= 50
##       rule290   0.26918576                 bdi &gt; 6 &amp; e4 &gt; 17
##         rule9  -0.14433149             e5 &gt; 10 &amp; open1 &lt;= 18
##       rule158   0.10740358                e5 &lt;= 18 &amp; n1 &gt; 13
##       rule485   0.09783142                e5 &lt;= 18 &amp; n4 &gt; 12
##         rule7   0.07625544                 n3 &gt; 13 &amp; e1 &gt; 18
##       rule306  -0.04958554                e5 &gt; 10 &amp; e1 &lt;= 23
##       rule241   0.03494634    n1 &gt; 13 &amp; e4 &gt; 17 &amp; altot &gt; 40
##       rule624  -0.02244494             open1 &lt;= 21 &amp; e5 &gt; 10</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">importance</span>(opt_pre_mod, <span class="at">penalty.par.val =</span> <span class="st">&quot;lambda.1se&quot;</span>, <span class="at">cex =</span> .<span class="dv">7</span>,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex.main =</span> .<span class="dv">7</span>, <span class="at">cex.lab =</span> .<span class="dv">7</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>pre_preds_opt <span class="ot">&lt;-</span> <span class="fu">predict</span>(opt_pre_mod, <span class="at">newdata =</span> carrillo[<span class="sc">-</span>train_ids, ], </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">penalty.par.val =</span> <span class="st">&quot;lambda.1se&quot;</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(carrillo[<span class="sc">-</span>train_ids, <span class="st">&quot;sexo&quot;</span>])<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((pre_preds_opt <span class="sc">-</span> y_test)<span class="sc">^</span><span class="dv">2</span>) <span class="do">## Brier score</span></span></code></pre></div>
<pre><code>## [1] 0.2315972</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>((pre_preds_opt <span class="sc">-</span> y_test)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(y_test)) <span class="do">## standard error of SEL</span></span></code></pre></div>
<pre><code>## [1] 0.0239903</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(<span class="at">response =</span> carrillo[<span class="sc">-</span>train_ids, <span class="st">&quot;sexo&quot;</span>], <span class="at">predictor =</span> pre_preds_opt)</span></code></pre></div>
<pre><code>## Area under the curve: 0.7583</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(def_pre_mod)</span></code></pre></div>
<pre><code>## 
## Final ensemble with cv error within 1se of minimum: 
##   lambda =  0.04362989
##   number of terms = 10
##   mean cv error (se) = 1.317266 (0.06728047)
## 
##   cv error type : Binomial Deviance</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pre_preds_def <span class="ot">&lt;-</span> <span class="fu">predict</span>(def_pre_mod, <span class="at">newdata =</span> carrillo[<span class="sc">-</span>train_ids, ], </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((pre_preds_def <span class="sc">-</span> y_test)<span class="sc">^</span><span class="dv">2</span>) <span class="do">## Brier score</span></span></code></pre></div>
<pre><code>## [1] 0.2457914</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>((pre_preds_def <span class="sc">-</span> y_test)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(y_test)) <span class="do">## standard error of SEL </span></span></code></pre></div>
<pre><code>## [1] 0.02729477</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(<span class="at">response =</span> carrillo[<span class="sc">-</span>train_ids, <span class="st">&quot;sexo&quot;</span>], <span class="at">predictor =</span> pre_preds_def)</span></code></pre></div>
<pre><code>## Area under the curve: 0.6861</code></pre>
<p>We obtained the best Brier score and AUC with the tuned parameter values. The difference in performance between tuned and default parameter settings is less than one standard error, but note the test set is very small in this example; larger test set size or (repeated) <span class="math inline">\(k\)</span>-fold cross validation should be preferred in practice.</p>
<p>The default settings yielded a slightly sparser rule ensemble than the parameters optimizing predictive accuracy as measured by the Brier score. This will commonly be encountered: <code>pre</code>â€™s default settings prefer a sparser ensemble over an ensemble that perfectly optimizes predictive accuracy. Small differences in accuracy may often be swamped by real-world aspects of a data problem (Efron, 2020; Hand, 2009).</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Efron, B. (2020). Prediction, estimation, and attribution. <em>International Statistical Review, 88</em>, S28-S59.</p>
<p>Hand, D. J. (2006). Classifier technology and the illusion of progress. <em>Statistical Science, 21</em>(1), 1-14.</p>
<p>Fokkema, M. (2020). Fitting Prediction Rule Ensembles with R package <strong><code>pre</code></strong>. <em>Journal of Statistical Software, 92</em>, 1-30. <a href="https://doi.org/10.18637/jss.v092.i12" class="uri">https://doi.org/10.18637/jss.v092.i12</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
